<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>What Is IDOR? Finding and Preventing Insecure Direct Object References in AWS APIs | The Hidden Port</title>
<meta name=keywords content="Bug Bounty,Security,Web,AWS,API,IDOR"><meta name=description content="A technical deep-dive into IDOR vulnerabilities, real bug-bounty cases, AWS API examples, detection, prevention strategies, and how to secure your AWS services."><meta name=author content="Javier Pulido"><link rel=canonical href=https://thehiddenport.dev/posts/what-is-idor-aws-apis/><link crossorigin=anonymous href=/assets/css/stylesheet.2211ca3164be7830024f6aad2b3a2e520843a64f8f048445c3401c1249aa051d.css integrity="sha256-IhHKMWS+eDACT2qtKzouUghDpk+PBIRFw0AcEkmqBR0=" rel="preload stylesheet" as=style><link rel=icon href=https://thehiddenport.dev/favicon.png><link rel=icon type=image/png sizes=16x16 href=https://thehiddenport.dev/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://thehiddenport.dev/favicon-32x32.png><link rel=apple-touch-icon href=https://thehiddenport.dev/apple-touch-icon.png><link rel=mask-icon href=https://thehiddenport.dev/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://thehiddenport.dev/posts/aws-preventing-idor/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script type=application/ld+json>{"@context":"https://schema.org","@type":"TechArticle","headline":"What Is IDOR? Finding and Preventing Insecure Direct Object References in AWS APIs","datePublished":"2025-06-27","author":{"@type":"Person","name":"Javier Pulido"},"publisher":{"@type":"Organization","name":"The Hidden Port"},"description":"A technical deep-dive into IDOR vulnerabilities, real bug-bounty cases, AWS API examples, detection, prevention strategies, and how to secure your AWS services.","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/thehiddenport.dev\/posts\/aws-preventing-idor\/"}}</script><link rel=icon type=image/png href=/favicon-32x32.png sizes=32x32><link rel=icon href=/favicon.ico type=image/x-icon><meta property="og:title" content="What Is IDOR? Finding and Preventing Insecure Direct Object References in AWS APIs"><meta property="og:type" content="article"><meta property="og:description" content="A technical deep-dive into IDOR vulnerabilities, real bug-bounty cases, AWS API examples, detection, prevention strategies, and how to secure your AWS services."><meta property="og:url" content="https://thehiddenport.dev/posts/aws-preventing-idor/"><meta property="og:image" content="https://thehiddenport.dev/images/default-preview.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="What Is IDOR? Finding and Preventing Insecure Direct Object References in AWS APIs"><meta name=twitter:description content="A technical deep-dive into IDOR vulnerabilities, real bug-bounty cases, AWS API examples, detection, prevention strategies, and how to secure your AWS services."><meta name=twitter:image content="https://thehiddenport.dev/images/default-preview.png"><link rel=canonical href=https://thehiddenport.dev/posts/aws-preventing-idor/><script src=https://analytics.ahrefs.com/analytics.js data-key=b4q7XOS5/fFZL+c9Jfry7Q async></script><link rel=alternate type=application/rss+xml title="The Hidden Port RSS Feed" href=/index.xml><script async src="https://www.googletagmanager.com/gtag/js?id=G-NJW0JJBT7G"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-NJW0JJBT7G")</script><script>(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-KZ4PZK7D")</script><meta property="og:url" content="https://thehiddenport.dev/posts/aws-preventing-idor/"><meta property="og:site_name" content="The Hidden Port"><meta property="og:title" content="What Is IDOR? Finding and Preventing Insecure Direct Object References in AWS APIs"><meta property="og:description" content="A technical deep-dive into IDOR vulnerabilities, real bug-bounty cases, AWS API examples, detection, prevention strategies, and how to secure your AWS services."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-06-27T00:00:00+00:00"><meta property="article:modified_time" content="2025-06-27T00:00:00+00:00"><meta property="article:tag" content="Bug Bounty"><meta property="article:tag" content="Security"><meta property="article:tag" content="Web"><meta property="article:tag" content="Aws"><meta property="article:tag" content="API"><meta property="article:tag" content="IDOR"><meta name=twitter:card content="summary"><meta name=twitter:title content="What Is IDOR? Finding and Preventing Insecure Direct Object References in AWS APIs"><meta name=twitter:description content="A technical deep-dive into IDOR vulnerabilities, real bug-bounty cases, AWS API examples, detection, prevention strategies, and how to secure your AWS services."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://thehiddenport.dev/posts/"},{"@type":"ListItem","position":2,"name":"What Is IDOR? Finding and Preventing Insecure Direct Object References in AWS APIs","item":"https://thehiddenport.dev/posts/aws-preventing-idor/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"What Is IDOR? Finding and Preventing Insecure Direct Object References in AWS APIs","name":"What Is IDOR? Finding and Preventing Insecure Direct Object References in AWS APIs","description":"A technical deep-dive into IDOR vulnerabilities, real bug-bounty cases, AWS API examples, detection, prevention strategies, and how to secure your AWS services.","keywords":["Bug Bounty","Security","Web","AWS","API","IDOR"],"articleBody":"What Is IDOR? Finding and Preventing Insecure Direct Object References in AWS APIs In bug bounty and pentesting, IDOR (Insecure Direct Object Reference) remains one of the most frequent and dangerous vulnerabilities—even today. OWASP defines it as a classic Broken Access Control issue, overwhelming APIs that use predictable or guessable object identifiers (cheatsheetseries.owasp.org). But its real impact goes beyond HTTP—IDOR can silently appear in AWS APIs, Lambda functions, and internal tooling. This post examines how that happens, how bounty hunters find them, and how AWS developers can prevent and detect IDOR effectively.\nPersonal Note I’m currently starting my journey into bug bounty hunting. Given my background in AWS security, I realized there’s a natural overlap between the two worlds—especially when it comes to misconfigurations, permission boundaries, and API behavior. This article is my first step into exploring that intersection.\nIf you’re curious to follow along as I dive deeper into bug bounty topics—real findings, tooling, and mindset—stay tuned. More coming soon.\nWhat Is IDOR? IDOR occurs when an application uses user-supplied identifiers (in URL, body, header, or cookie) to reference internal objects without verifying ownership or permissions. It comes in flavors:\nURL tampering: Changing GET /orders?id=1234 to id=1235 to access someone else’s order. Body tampering: Modifying JSON body in POST/PUT to point at unauthorized user ids. Header/cookie manipulation: Modifying session tokens or headers like X-User-ID. Path traversal cases: IDOR via file paths or uploaded object references. Despite best practices, IDOR stays frequent. One bug-hunter reported ~220 IDOR finds out of 650 bounties in a year (reddit.com).\nAWS API IDOR: A Bug Bounty Sweet Spot On AWS, IDOR may “live” in:\nCustom APIs backed by DynamoDB or S3\nExample: GET /user-files?fileId=123 without checking if current user owns fileId Dynamo allows querying without owner checks—easy to exploit Internal tooling using AWS SDK\nUnpublished endpoints with objectKey or roleArn parameters, similar vulnerability Metadata abuse scenarios\nA Lambda calling iam.getUser({UserName: input}) without proper validation Sample IDOR Scenario in AWS POST /internal/api/lambda/invoke { \"functionName\": \"user-lambdas-arn\", \"payload\": { \"userId\": \"1234\", \"action\": \"listSecrets\" } } If backend doesn’t check the authenticated Lambda’s permissions before calling AWS APIs like ListSecrets, an attacker could escalate privileges. Many abused internal lambdas share this pattern.\nWhy IDOR Is Dangerous in AWS Environments In AWS, IDOR can lead to elevated risk beyond stolen data:\nRisk Description Cross-account leakage Exfiltrate data from other AWS accounts AssumeRole abuse Use vulnerable APIs to call sts:AssumeRole({RoleArn:...}) Privilege escalation Access unauthorized secrets, functions, roles Large-scale enumeration Automate API calls to enumerate S3, DB, IAM With AWS’s “programmatic everything” model, these bugs can scale to severe breaches, as multiple researchers have demonstrated (comolho.com).\nHunting IDOR in AWS APIs 1. Inventory APIs \u0026 Parameters Map out all internal APIs—Lambda proxies, API Gateway, custom services—and identify params like userId, resourceId, fileKey, orderId.\n2. Test for direct object access Send requests with someone else’s known identifiers (e.g., ?id=1). Erroneous access or HTTP 200 for wrong objects? Found IDOR.\n3. Automate enumeration With tools like ffuf or burp intruder, fuzz resourceId: 1000–1010, or test for UUID formats. Look for differences in responses.\n4. Monitor enumeration attempts If APIs log every SELECT * WHERE id = ?, watch CloudWatch Logs for weird 404 patterns—indicates enumeration.\n5. Review IAM permissions Check if callers are authorized to access underlying resources (Dynamo, S3). If object access relies solely on client-sent IDs, it’s likely vulnerable.\nPreventing IDOR in AWS Best practices aligned with OWASP guidance include (cheatsheetseries.owasp.org):\nAlways verify object ownership in code:\nconst item = await dynamo.get({Key:{userId: currentUser, objectId: inputId}}); if (!item) throw new Error(\"Not found\"); Use indirect references for public APIs\nGenerate UUIDs or random keys instead of sequential integers, but access control is non-negotiable. Scope AWS permissions appropriately\nAvoid Resource: \"*\". Use fine-grained Condition blocks (e.g., dynamodb:LeadingKeys set to ${aws:userid}). Rate-limit and detect enumeration\nCloudFront or WAF rules can throttle suspicious enumeration patterns. Log everything\nEmit structured logs to CloudWatch, alert on spikes of unauthorized requests or repeated access attempts. Detection \u0026 Alerting Strategy Use CloudTrail + EventBridge for IDOR Detection Any API returning 404 or 200 on unexpected IDs can trigger alerts:\n{ \"detail-type\": [\"API Call via CloudTrail\"], \"detail\": { \"eventSource\": [\"execute-api.amazonaws.com\"], \"httpStatus\": [\"200\"], \"requestParameters\": { \"resourceId\": [\"*\"] } } } Then trigger SNS or Lambda to log suspicious enumeration.\nLog-based alerts in CloudWatch Watch for:\nMany 404s within a minute Access to resources owned by a different AWS account or user Putting It All Together: A Hardened Example API Gateway → Lambda → DynamoDB access Lambda code strictly checks userId ownership IAM policy only allows access to items under ${aws:userid} WAF blocks \u003e50 requests/minute per IP to /internal/api/ CloudTrail/CloudWatch logs feed into SIEM alerts for anomalies Why IDOR Still Wins in Bug Bounty Despite being well-known, IDOR persists due to:\nFast development cycles: devs quickly expose objects without validation. False confidence in UUIDs: obfuscation ≠ security. Lack of server-side enforcement: clients control identifiers, so attackers can enumerate. Related Reading My full IAM least privilege guide EventBridge detection for privilege escalation EC2 Hardening \u0026 AMI automation Final Thoughts IDOR is simple to understand—but complex to eliminate completely, especially in cloud environments. With thoughtful access control, logging, detection, and auditing, you can significantly reduce risk. For bug hunters, IDOR remains a low-hanging but impactful vulnerability, especially when combined with AWS APIs or internal tools.\nKeep hunting, keep securing—and if you find an AWS-based IDOR, do share the example (anonymized) so the whole community learns with you.\n","wordCount":"902","inLanguage":"en","datePublished":"2025-06-27T00:00:00Z","dateModified":"2025-06-27T00:00:00Z","author":[{"@type":"Person","name":"Javier Pulido"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://thehiddenport.dev/posts/aws-preventing-idor/"},"publisher":{"@type":"Organization","name":"The Hidden Port","logo":{"@type":"ImageObject","url":"https://thehiddenport.dev/favicon.png"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=https://thehiddenport.dev/ accesskey=h title="The Hidden Port (Alt + H)">The Hidden Port</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://thehiddenport.dev/ title=Home><span>Home</span></a></li><li><a href=https://thehiddenport.dev/about/ title=About><span>About</span></a></li><li><a href=https://thehiddenport.dev/resources/ title=Resources><span>Resources</span></a></li><li><a href=https://thehiddenport.dev/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://thehiddenport.dev/blog/ title=Blog><span>Blog</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://thehiddenport.dev/>Home</a>&nbsp;»&nbsp;<a href=https://thehiddenport.dev/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">What Is IDOR? Finding and Preventing Insecure Direct Object References in AWS APIs</h1><div class=post-description>A technical deep-dive into IDOR vulnerabilities, real bug-bounty cases, AWS API examples, detection, prevention strategies, and how to secure your AWS services.</div><div class=post-meta><span title='2025-06-27 00:00:00 +0000 UTC'>June 27, 2025</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;902 words&nbsp;·&nbsp;Javier Pulido</div></header><div class=post-content><h1 id=what-is-idor-finding-and-preventing-insecure-direct-object-references-in-aws-apis>What Is IDOR? Finding and Preventing Insecure Direct Object References in AWS APIs<a hidden class=anchor aria-hidden=true href=#what-is-idor-finding-and-preventing-insecure-direct-object-references-in-aws-apis>#</a></h1><p>In bug bounty and pentesting, <strong>IDOR (Insecure Direct Object Reference)</strong> remains one of the most frequent and dangerous vulnerabilities—even today. OWASP defines it as a classic <strong>Broken Access Control</strong> issue, overwhelming APIs that use predictable or guessable object identifiers (<a href=https://cheatsheetseries.owasp.org/cheatsheets/Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet.html>cheatsheetseries.owasp.org</a>). But its real impact goes beyond HTTP—IDOR can silently appear in <strong>AWS APIs</strong>, Lambda functions, and internal tooling. This post examines how that happens, how bounty hunters find them, and how AWS developers can prevent and detect IDOR effectively.</p><hr><h1 id=personal-note>Personal Note<a hidden class=anchor aria-hidden=true href=#personal-note>#</a></h1><p>I&rsquo;m currently starting my journey into bug bounty hunting. Given my background in AWS security, I realized there’s a natural overlap between the two worlds—especially when it comes to misconfigurations, permission boundaries, and API behavior. This article is my first step into exploring that intersection.</p><p>If you’re curious to follow along as I dive deeper into bug bounty topics—real findings, tooling, and mindset—stay tuned. More coming soon.</p><h2 id=what-is-idor>What Is IDOR?<a hidden class=anchor aria-hidden=true href=#what-is-idor>#</a></h2><p>IDOR occurs when an application uses <strong>user-supplied identifiers</strong> (in URL, body, header, or cookie) to reference internal objects <em>without verifying ownership or permissions</em>. It comes in flavors:</p><ul><li><strong>URL tampering</strong>: Changing <code>GET /orders?id=1234</code> to <code>id=1235</code> to access someone else’s order.</li><li><strong>Body tampering</strong>: Modifying JSON body in POST/PUT to point at unauthorized user ids.</li><li><strong>Header/cookie manipulation</strong>: Modifying session tokens or headers like <code>X-User-ID</code>.</li><li><strong>Path traversal cases</strong>: IDOR via file paths or uploaded object references.</li></ul><p>Despite best practices, IDOR stays frequent. One bug-hunter reported ~220 IDOR finds out of 650 bounties in a year (<a href=https://www.reddit.com/r/cybersecurity/comments/15y5f56>reddit.com</a>).</p><hr><h2 id=aws-api-idor-a-bug-bounty-sweet-spot>AWS API IDOR: A Bug Bounty Sweet Spot<a hidden class=anchor aria-hidden=true href=#aws-api-idor-a-bug-bounty-sweet-spot>#</a></h2><p>On AWS, IDOR may “live” in:</p><ol><li><p><strong>Custom APIs backed by DynamoDB or S3</strong></p><ul><li>Example: <code>GET /user-files?fileId=123</code> without checking if current user owns <code>fileId</code></li><li>Dynamo allows querying without owner checks—easy to exploit</li></ul></li><li><p><strong>Internal tooling</strong> using AWS SDK</p><ul><li>Unpublished endpoints with <code>objectKey</code> or <code>roleArn</code> parameters, similar vulnerability</li></ul></li><li><p><strong>Metadata abuse scenarios</strong></p><ul><li>A Lambda calling <code>iam.getUser({UserName: input})</code> without proper validation</li></ul></li></ol><hr><h3 id=sample-idor-scenario-in-aws>Sample IDOR Scenario in AWS<a hidden class=anchor aria-hidden=true href=#sample-idor-scenario-in-aws>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>POST /internal/api/lambda/invoke
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>{
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>  &#34;functionName&#34;: &#34;user-lambdas-arn&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>  &#34;payload&#34;: { &#34;userId&#34;: &#34;1234&#34;, &#34;action&#34;: &#34;listSecrets&#34; }
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}
</span></span></span></code></pre></div><p>If backend doesn’t check the authenticated Lambda’s permissions before calling AWS APIs like <code>ListSecrets</code>, an attacker could escalate privileges. Many abused internal lambdas share this pattern.</p><hr><h2 id=why-idor-is-dangerous-in-aws-environments>Why IDOR Is Dangerous in AWS Environments<a hidden class=anchor aria-hidden=true href=#why-idor-is-dangerous-in-aws-environments>#</a></h2><p>In AWS, IDOR can lead to elevated risk beyond stolen data:</p><table><thead><tr><th>Risk</th><th>Description</th></tr></thead><tbody><tr><td><strong>Cross-account leakage</strong></td><td>Exfiltrate data from other AWS accounts</td></tr><tr><td><strong>AssumeRole abuse</strong></td><td>Use vulnerable APIs to call <code>sts:AssumeRole({RoleArn:...})</code></td></tr><tr><td><strong>Privilege escalation</strong></td><td>Access unauthorized secrets, functions, roles</td></tr><tr><td><strong>Large-scale enumeration</strong></td><td>Automate API calls to enumerate S3, DB, IAM</td></tr></tbody></table><p>With AWS’s &ldquo;programmatic everything&rdquo; model, these bugs can scale to severe breaches, as multiple researchers have demonstrated (<a href=https://www.comolho.com/post/hijacking-the-cloud-an-aws-takeover-and-rce-taleat-xyz-company>comolho.com</a>).</p><hr><h2 id=hunting-idor-in-aws-apis>Hunting IDOR in AWS APIs<a hidden class=anchor aria-hidden=true href=#hunting-idor-in-aws-apis>#</a></h2><h3 id=1-inventory-apis--parameters>1. <strong>Inventory APIs & Parameters</strong><a hidden class=anchor aria-hidden=true href=#1-inventory-apis--parameters>#</a></h3><p>Map out all internal APIs—Lambda proxies, API Gateway, custom services—and identify params like <code>userId</code>, <code>resourceId</code>, <code>fileKey</code>, <code>orderId</code>.</p><h3 id=2-test-for-direct-object-access>2. <strong>Test for direct object access</strong><a hidden class=anchor aria-hidden=true href=#2-test-for-direct-object-access>#</a></h3><p>Send requests with someone else’s known identifiers (e.g., <code>?id=1</code>). Erroneous access or HTTP 200 for wrong objects? Found IDOR.</p><h3 id=3-automate-enumeration>3. <strong>Automate enumeration</strong><a hidden class=anchor aria-hidden=true href=#3-automate-enumeration>#</a></h3><p>With tools like <strong>ffuf</strong> or <strong>burp intruder</strong>, fuzz <code>resourceId</code>: <code>1000–1010</code>, or test for UUID formats. Look for differences in responses.</p><h3 id=4-monitor-enumeration-attempts>4. <strong>Monitor enumeration attempts</strong><a hidden class=anchor aria-hidden=true href=#4-monitor-enumeration-attempts>#</a></h3><p>If APIs log every <code>SELECT * WHERE id = ?</code>, watch CloudWatch Logs for weird 404 patterns—indicates enumeration.</p><h3 id=5-review-iam-permissions>5. <strong>Review IAM permissions</strong><a hidden class=anchor aria-hidden=true href=#5-review-iam-permissions>#</a></h3><p>Check if callers are authorized to access underlying resources (Dynamo, S3). If object access relies solely on client-sent IDs, it’s likely vulnerable.</p><hr><h2 id=preventing-idor-in-aws>Preventing IDOR in AWS<a hidden class=anchor aria-hidden=true href=#preventing-idor-in-aws>#</a></h2><p>Best practices aligned with OWASP guidance include (<a href=https://cheatsheetseries.owasp.org/cheatsheets/Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet.html>cheatsheetseries.owasp.org</a>):</p><ol><li><p><strong>Always verify object ownership in code</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>item</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>dynamo</span>.<span style=color:#a6e22e>get</span>({<span style=color:#a6e22e>Key</span><span style=color:#f92672>:</span>{<span style=color:#a6e22e>userId</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>currentUser</span>, <span style=color:#a6e22e>objectId</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>inputId</span>}});
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>item</span>) <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Error(<span style=color:#e6db74>&#34;Not found&#34;</span>);
</span></span></code></pre></div></li><li><p><strong>Use indirect references</strong> for public APIs</p><ul><li>Generate UUIDs or random keys instead of sequential integers, but access control is non-negotiable.</li></ul></li><li><p><strong>Scope AWS permissions appropriately</strong></p><ul><li>Avoid <code>Resource: "*"</code>. Use fine-grained <code>Condition</code> blocks (e.g., <code>dynamodb:LeadingKeys</code> set to <code>${aws:userid}</code>).</li></ul></li><li><p><strong>Rate-limit and detect enumeration</strong></p><ul><li>CloudFront or WAF rules can throttle suspicious enumeration patterns.</li></ul></li><li><p><strong>Log everything</strong></p><ul><li>Emit structured logs to CloudWatch, alert on spikes of unauthorized requests or repeated access attempts.</li></ul></li></ol><hr><h2 id=detection--alerting-strategy>Detection & Alerting Strategy<a hidden class=anchor aria-hidden=true href=#detection--alerting-strategy>#</a></h2><h3 id=use-cloudtrail--eventbridge-for-idor-detection>Use CloudTrail + EventBridge for IDOR Detection<a hidden class=anchor aria-hidden=true href=#use-cloudtrail--eventbridge-for-idor-detection>#</a></h3><p>Any API returning 404 or 200 on unexpected IDs can trigger alerts:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;detail-type&#34;</span>: [<span style=color:#e6db74>&#34;API Call via CloudTrail&#34;</span>],
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;detail&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;eventSource&#34;</span>: [<span style=color:#e6db74>&#34;execute-api.amazonaws.com&#34;</span>],
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;httpStatus&#34;</span>: [<span style=color:#e6db74>&#34;200&#34;</span>],
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;requestParameters&#34;</span>: {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;resourceId&#34;</span>: [<span style=color:#e6db74>&#34;*&#34;</span>]
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Then trigger SNS or Lambda to log suspicious enumeration.</p><h3 id=log-based-alerts-in-cloudwatch>Log-based alerts in CloudWatch<a hidden class=anchor aria-hidden=true href=#log-based-alerts-in-cloudwatch>#</a></h3><p>Watch for:</p><ul><li>Many 404s within a minute</li><li>Access to resources owned by a different AWS account or user</li></ul><hr><h2 id=putting-it-all-together-a-hardened-example>Putting It All Together: A Hardened Example<a hidden class=anchor aria-hidden=true href=#putting-it-all-together-a-hardened-example>#</a></h2><ul><li>API Gateway → Lambda → DynamoDB access</li><li>Lambda code strictly checks <code>userId</code> ownership</li><li>IAM policy only allows access to items under <code>${aws:userid}</code></li><li>WAF blocks >50 requests/minute per IP to <code>/internal/api/</code></li><li>CloudTrail/CloudWatch logs feed into SIEM alerts for anomalies</li></ul><hr><h2 id=why-idor-still-wins-in-bug-bounty>Why IDOR Still Wins in Bug Bounty<a hidden class=anchor aria-hidden=true href=#why-idor-still-wins-in-bug-bounty>#</a></h2><p>Despite being well-known, IDOR persists due to:</p><ul><li><strong>Fast development cycles</strong>: devs quickly expose objects without validation.</li><li><strong>False confidence in UUIDs</strong>: obfuscation ≠ security.</li><li><strong>Lack of server-side enforcement</strong>: clients control identifiers, so attackers can enumerate.</li></ul><hr><h2 id=related-reading>Related Reading<a hidden class=anchor aria-hidden=true href=#related-reading>#</a></h2><ul><li><a href=/posts/aws-enforcing-least-privilege/>My full IAM least privilege guide</a></li><li><a href=/posts/aws-detecting-privilege-escalation/>EventBridge detection for privilege escalation</a></li><li><a href=/posts/aws-ec2-hardening/>EC2 Hardening & AMI automation</a></li></ul><hr><h2 id=final-thoughts>Final Thoughts<a hidden class=anchor aria-hidden=true href=#final-thoughts>#</a></h2><p>IDOR is simple to understand—but complex to eliminate completely, especially in cloud environments. With thoughtful access control, logging, detection, and auditing, you can significantly reduce risk. For bug hunters, IDOR remains a low-hanging but impactful vulnerability, especially when combined with AWS APIs or internal tools.</p><p>Keep hunting, keep securing—and if you find an AWS-based IDOR, do share the example (anonymized) so the whole community learns with you.</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 8 9"><g transform="translate(8,16)"/></svg></div></div><section class="mt-10 border-t border-gray-700 pt-6"><div class="flex items-center space-x-4"><div class=text-gray-400><p class=text-sm>Written by <span class="font-semibold text-gray-300">Javier Pulido</span><br>Cloud Security Engineer | Founder of <span class=italic>The Hidden Port</span><br><a href=/about/ class="text-primary hover:underline text-sm">Learn more ➔</a></p></div></div></section><hr><section class=mt-10><h2 style=padding-bottom:10px class="text-2xl font-semibold mb-4">Related Posts by tags</h2><br><span><a style=font-size:17px href=https://thehiddenport.dev/posts/aws-guardduty-setup/ class="title next hover:text-primary">Getting Started with Amazon GuardDuty: Setup, Findings, and SIEM Integration</a></span></br><span><a style=font-size:17px href=https://thehiddenport.dev/posts/aws-detecting-privilege-escalation/ class="title next hover:text-primary">Detecting Privilege Escalation in AWS Using CloudTrail and EventBridge</a></span></br><span><a style=font-size:17px href=https://thehiddenport.dev/posts/aws-ami-hardening/ class="title next hover:text-primary">Building a Hardened Amazon Linux 2 AMI for Secure EC2 Deployments</a></span></br></section><hr><footer class=post-footer><ul class=post-tags><li><a href=https://thehiddenport.dev/tags/bug-bounty/>Bug Bounty</a></li><li><a href=https://thehiddenport.dev/tags/security/>Security</a></li><li><a href=https://thehiddenport.dev/tags/web/>Web</a></li><li><a href=https://thehiddenport.dev/tags/aws/>Aws</a></li><li><a href=https://thehiddenport.dev/tags/api/>API</a></li><li><a href=https://thehiddenport.dev/tags/idor/>IDOR</a></li></ul><nav class=paginav><a class=prev href=https://thehiddenport.dev/posts/ejptv2-journey/><span class=title>« Prev</span><br><span>From Cloud Security to Pentesting: My eJPTv2 Journey</span>
</a><a class=next href=https://thehiddenport.dev/posts/aws-guardduty-setup/><span class=title>Next »</span><br><span>Getting Started with Amazon GuardDuty: Setup, Findings, and SIEM Integration</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share What Is IDOR? Finding and Preventing Insecure Direct Object References in AWS APIs on x" href="https://x.com/intent/tweet/?text=What%20Is%20IDOR%3f%20Finding%20and%20Preventing%20Insecure%20Direct%20Object%20References%20in%20AWS%20APIs&amp;url=https%3a%2f%2fthehiddenport.dev%2fposts%2faws-preventing-idor%2f&amp;hashtags=BugBounty%2cSecurity%2cWeb%2cAWS%2cAPI%2cIDOR"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share What Is IDOR? Finding and Preventing Insecure Direct Object References in AWS APIs on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fthehiddenport.dev%2fposts%2faws-preventing-idor%2f&amp;title=What%20Is%20IDOR%3f%20Finding%20and%20Preventing%20Insecure%20Direct%20Object%20References%20in%20AWS%20APIs&amp;summary=What%20Is%20IDOR%3f%20Finding%20and%20Preventing%20Insecure%20Direct%20Object%20References%20in%20AWS%20APIs&amp;source=https%3a%2f%2fthehiddenport.dev%2fposts%2faws-preventing-idor%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share What Is IDOR? Finding and Preventing Insecure Direct Object References in AWS APIs on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fthehiddenport.dev%2fposts%2faws-preventing-idor%2f&title=What%20Is%20IDOR%3f%20Finding%20and%20Preventing%20Insecure%20Direct%20Object%20References%20in%20AWS%20APIs"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share What Is IDOR? Finding and Preventing Insecure Direct Object References in AWS APIs on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fthehiddenport.dev%2fposts%2faws-preventing-idor%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share What Is IDOR? Finding and Preventing Insecure Direct Object References in AWS APIs on whatsapp" href="https://api.whatsapp.com/send?text=What%20Is%20IDOR%3f%20Finding%20and%20Preventing%20Insecure%20Direct%20Object%20References%20in%20AWS%20APIs%20-%20https%3a%2f%2fthehiddenport.dev%2fposts%2faws-preventing-idor%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share What Is IDOR? Finding and Preventing Insecure Direct Object References in AWS APIs on telegram" href="https://telegram.me/share/url?text=What%20Is%20IDOR%3f%20Finding%20and%20Preventing%20Insecure%20Direct%20Object%20References%20in%20AWS%20APIs&amp;url=https%3a%2f%2fthehiddenport.dev%2fposts%2faws-preventing-idor%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share What Is IDOR? Finding and Preventing Insecure Direct Object References in AWS APIs on ycombinator" href="https://news.ycombinator.com/submitlink?t=What%20Is%20IDOR%3f%20Finding%20and%20Preventing%20Insecure%20Direct%20Object%20References%20in%20AWS%20APIs&u=https%3a%2f%2fthehiddenport.dev%2fposts%2faws-preventing-idor%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://thehiddenport.dev/>The Hidden Port</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><style>.subscribe-footer{margin-top:3rem;padding-top:1.5rem;border-top:1px solid #444;text-align:center!important;justify-content:center;align-items:center}.subscribe-footer .eo-wrapper{width:100%;max-width:500px;display:flex;justify-content:center}</style><div class=subscribe-footer><a href=/disclaimer/ class="linktext-xs text-gray-500 hover:text-primary">Disclaimer</a></div><script>const form=document.getElementById("newsletter-form"),successMessage=document.getElementById("subscribe-success");form.addEventListener("submit",async function(e){e.preventDefault();const t=new FormData(form),n=await fetch(form.action,{method:form.method,body:t});n.ok&&(form.reset(),successMessage.classList.add("show"),successMessage.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{successMessage.classList.remove("show"),successMessage.classList.add("hide")},5e3))})</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script async src=https://eocampaign1.com/form/fbc81a40-4aea-11f0-aff3-45842a94a714.js data-form=fbc81a40-4aea-11f0-aff3-45842a94a714></script></body></html>