<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Detecting Privilege Escalation in AWS Using CloudTrail and EventBridge | The Hidden Port</title>
<meta name=keywords content="AWS,IAM,CloudTrail,EventBridge,Detection,Security"><meta name=description content="Learn how to detect IAM privilege escalation attempts in AWS using CloudTrail logs, EventBridge rules, and practical detection engineering strategies. Includes examples, alerting techniques, and real-world API call patterns."><meta name=author content="Javier Pulido"><link rel=canonical href=https://thehiddenport.dev/posts/aws-detecting-privilege-escalation-cloudtrail-eventbridge/><link crossorigin=anonymous href=/assets/css/stylesheet.2211ca3164be7830024f6aad2b3a2e520843a64f8f048445c3401c1249aa051d.css integrity="sha256-IhHKMWS+eDACT2qtKzouUghDpk+PBIRFw0AcEkmqBR0=" rel="preload stylesheet" as=style><link rel=icon href=https://thehiddenport.dev/favicon.png><link rel=icon type=image/png sizes=16x16 href=https://thehiddenport.dev/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://thehiddenport.dev/favicon-32x32.png><link rel=apple-touch-icon href=https://thehiddenport.dev/apple-touch-icon.png><link rel=mask-icon href=https://thehiddenport.dev/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://thehiddenport.dev/posts/aws-detecting-privilege-escalation/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script type=application/ld+json>{"@context":"https://schema.org","@type":"TechArticle","headline":"Detecting Privilege Escalation in AWS Using CloudTrail and EventBridge","datePublished":"2025-06-20","author":{"@type":"Person","name":"Javier Pulido"},"publisher":{"@type":"Organization","name":"The Hidden Port"},"description":"Learn how to detect IAM privilege escalation attempts in AWS using CloudTrail logs, EventBridge rules, and practical detection engineering strategies. Includes examples, alerting techniques, and real-world API call patterns.","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/thehiddenport.dev\/posts\/aws-detecting-privilege-escalation\/"}}</script><link rel=icon type=image/png href=/favicon-32x32.png sizes=32x32><link rel=icon href=/favicon.ico type=image/x-icon><meta property="og:title" content="Detecting Privilege Escalation in AWS Using CloudTrail and EventBridge"><meta property="og:type" content="article"><meta property="og:description" content="Learn how to detect IAM privilege escalation attempts in AWS using CloudTrail logs, EventBridge rules, and practical detection engineering strategies. Includes examples, alerting techniques, and real-world API call patterns."><meta property="og:url" content="https://thehiddenport.dev/posts/aws-detecting-privilege-escalation/"><meta property="og:image" content="https://thehiddenport.dev/images/default-preview.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Detecting Privilege Escalation in AWS Using CloudTrail and EventBridge"><meta name=twitter:description content="Learn how to detect IAM privilege escalation attempts in AWS using CloudTrail logs, EventBridge rules, and practical detection engineering strategies. Includes examples, alerting techniques, and real-world API call patterns."><meta name=twitter:image content="https://thehiddenport.dev/images/default-preview.png"><link rel=canonical href=https://thehiddenport.dev/posts/aws-detecting-privilege-escalation/><script src=https://analytics.ahrefs.com/analytics.js data-key=b4q7XOS5/fFZL+c9Jfry7Q async></script><link rel=alternate type=application/rss+xml title="The Hidden Port RSS Feed" href=/index.xml><script async src="https://www.googletagmanager.com/gtag/js?id=G-NJW0JJBT7G"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-NJW0JJBT7G")</script><script>(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-KZ4PZK7D")</script><meta property="og:url" content="https://thehiddenport.dev/posts/aws-detecting-privilege-escalation/"><meta property="og:site_name" content="The Hidden Port"><meta property="og:title" content="Detecting Privilege Escalation in AWS Using CloudTrail and EventBridge"><meta property="og:description" content="Learn how to detect IAM privilege escalation attempts in AWS using CloudTrail logs, EventBridge rules, and practical detection engineering strategies. Includes examples, alerting techniques, and real-world API call patterns."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-06-20T00:00:00+00:00"><meta property="article:modified_time" content="2025-06-20T00:00:00+00:00"><meta property="article:tag" content="Aws"><meta property="article:tag" content="Iam"><meta property="article:tag" content="Cloudtrail"><meta property="article:tag" content="Eventbridge"><meta property="article:tag" content="Detection"><meta property="article:tag" content="Security"><meta name=twitter:card content="summary"><meta name=twitter:title content="Detecting Privilege Escalation in AWS Using CloudTrail and EventBridge"><meta name=twitter:description content="Learn how to detect IAM privilege escalation attempts in AWS using CloudTrail logs, EventBridge rules, and practical detection engineering strategies. Includes examples, alerting techniques, and real-world API call patterns."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://thehiddenport.dev/posts/"},{"@type":"ListItem","position":2,"name":"Detecting Privilege Escalation in AWS Using CloudTrail and EventBridge","item":"https://thehiddenport.dev/posts/aws-detecting-privilege-escalation/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Detecting Privilege Escalation in AWS Using CloudTrail and EventBridge","name":"Detecting Privilege Escalation in AWS Using CloudTrail and EventBridge","description":"Learn how to detect IAM privilege escalation attempts in AWS using CloudTrail logs, EventBridge rules, and practical detection engineering strategies. Includes examples, alerting techniques, and real-world API call patterns.","keywords":["AWS","IAM","CloudTrail","EventBridge","Detection","Security"],"articleBody":"Detecting Privilege Escalation in AWS Using CloudTrail and EventBridge One of the most dangerous threats in an AWS environment is privilege escalation—when an entity (a user, role, or service) gains more permissions than it should, either by misconfiguration or abuse. Detecting these escalation attempts is essential to protecting your cloud environment.\nAWS does not provide out-of-the-box detection for many of these patterns, but with CloudTrail, EventBridge, and some detection engineering, you can build native alerts for high-risk API calls that indicate an escalation in progress—or one about to happen.\nThis article will dive deep into:\nWhy privilege escalation is critical How attackers typically escalate privileges in AWS Which CloudTrail events to monitor How to configure EventBridge to catch suspicious patterns How to alert in real-time (SNS, Lambda, etc.) Caveats and tuning recommendations Why Privilege Escalation Matters in AWS Unlike traditional infrastructure, in AWS permissions are programmable, and every misstep can have systemic impact. Privilege escalation is not theoretical—it has been exploited both in internal red team exercises and real-world attacks.\nFor example, an attacker with limited access to Lambda functions might:\nModify an existing function to assume a high-privilege IAM role Add a new inline policy to their own user Or pass an admin role to an EC2 instance they control All of these leave traces in CloudTrail—if you’re watching.\nCommon Privilege Escalation Techniques in AWS Most escalation paths involve IAM or STS actions. Here are common patterns:\nAction What It Does iam:AttachUserPolicy / AttachRolePolicy Grants an existing policy to a principal iam:PutUserPolicy / PutRolePolicy Creates an inline policy (can contain anything) iam:PassRole + ec2:RunInstances Launches EC2 with powerful role attached lambda:UpdateFunctionCode + iam:PassRole Runs arbitrary code under elevated permissions sts:AssumeRole Switches identity if allowed by trust policy iam:CreatePolicyVersion May set an older, more permissive version as active Even if you’re using SCPs or guardrails, these events are useful for threat hunting or detection.\nCloudTrail Configuration Ensure you have:\nCloudTrail enabled in all regions Logging for management events Optionally delivering to an S3 bucket and integrated with CloudWatch Logs to bypass the 90 day retention limit of Cloudtrail All of the mentioned escalation actions are management events, and appear in CloudTrail as part of the eventName field.\nExample CloudTrail log (truncated):\n{ \"eventName\": \"AttachUserPolicy\", \"eventSource\": \"iam.amazonaws.com\", \"userIdentity\": { \"type\": \"IAMUser\", \"userName\": \"alice\" }, \"requestParameters\": { \"userName\": \"alice\", \"policyArn\": \"arn:aws:iam::aws:policy/AdministratorAccess\" }, ... } Creating Detection Rules with EventBridge EventBridge can subscribe to the CloudTrail event stream and match on suspicious API calls. You can then trigger notifications or automated actions.\nRule Example: Detect AttachUserPolicy { \"source\": [\"aws.iam\"], \"detail-type\": [\"AWS API Call via CloudTrail\"], \"detail\": { \"eventName\": [\"AttachUserPolicy\", \"PutUserPolicy\"], \"requestParameters.policyArn\": [{ \"prefix\": \"arn:aws:iam::aws:policy/AdministratorAccess\" }] } } This rule matches when someone attaches AdministratorAccess to themselves (or anyone).\nOther Useful Event Names to Watch CreatePolicy CreatePolicyVersion SetDefaultPolicyVersion PutRolePolicy PassRole AssumeRole If you’re watching cross-service escalation:\nRunInstances (check if iam:PassRole was used) UpdateFunctionCode (especially if the Lambda uses an elevated role) Alerting via SNS or Lambda Once your EventBridge rule matches, you can:\nTrigger an SNS notification (email, Slack, SMS) Invoke a Lambda function that writes to a SIEM, sends to Discord, or logs to S3 Write to CloudWatch Logs for later review Example: Send to SNS { \"State\": \"ENABLED\", \"Targets\": [ { \"Arn\": \"arn:aws:sns:us-east-1:111122223333:PrivEscAlerts\", \"Id\": \"PrivEscAlertTarget\" } ] } Tuning and Limitations False Positives Some actions might be part of normal automation pipelines Devs might update Lambda or IAM configs legitimately You can reduce noise by:\nFiltering on userIdentity.principalId or userName Excluding known automation roles (with conditions in EventBridge) Only alerting on attachments of privileged policies (e.g., AdministratorAccess, PowerUserAccess) Blind Spots Inline policy abuse might not be obvious If CloudTrail isn’t enabled in all regions, you’ll miss stuff Identity switching (sts:AssumeRole) requires combining multiple events to trace the full chain Related Reading If this post interests you, check these out:\nEnforcing Least Privilege in AWS IAM AWS Incident Response Toolkit Securing EC2 Access with AWS Systems Manager AWS Security Checklist 2025 Conclusion Privilege escalation is one of the most critical actions you need to monitor in AWS. While AWS provides the logs (via CloudTrail), it’s your responsibility to wire up detection logic. Thankfully, with EventBridge and a few well-designed rules, you can begin detecting these escalation attempts in near real-time.\nEven a single detection rule—targeting AttachUserPolicy with AdministratorAccess—can surface abuse before it becomes a breach.\nDon’t wait for an incident to act. Harden your detection stack today.\n","wordCount":"734","inLanguage":"en","datePublished":"2025-06-20T00:00:00Z","dateModified":"2025-06-20T00:00:00Z","author":[{"@type":"Person","name":"Javier Pulido"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://thehiddenport.dev/posts/aws-detecting-privilege-escalation/"},"publisher":{"@type":"Organization","name":"The Hidden Port","logo":{"@type":"ImageObject","url":"https://thehiddenport.dev/favicon.png"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=https://thehiddenport.dev/ accesskey=h title="The Hidden Port (Alt + H)">The Hidden Port</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://thehiddenport.dev/ title=Home><span>Home</span></a></li><li><a href=https://thehiddenport.dev/about/ title=About><span>About</span></a></li><li><a href=https://thehiddenport.dev/resources/ title=Resources><span>Resources</span></a></li><li><a href=https://thehiddenport.dev/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://thehiddenport.dev/blog/ title=Blog><span>Blog</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://thehiddenport.dev/>Home</a>&nbsp;»&nbsp;<a href=https://thehiddenport.dev/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Detecting Privilege Escalation in AWS Using CloudTrail and EventBridge</h1><div class=post-description>Learn how to detect IAM privilege escalation attempts in AWS using CloudTrail logs, EventBridge rules, and practical detection engineering strategies. Includes examples, alerting techniques, and real-world API call patterns.</div><div class=post-meta><span title='2025-06-20 00:00:00 +0000 UTC'>June 20, 2025</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;734 words&nbsp;·&nbsp;Javier Pulido</div></header><div class=post-content><h1 id=detecting-privilege-escalation-in-aws-using-cloudtrail-and-eventbridge>Detecting Privilege Escalation in AWS Using CloudTrail and EventBridge<a hidden class=anchor aria-hidden=true href=#detecting-privilege-escalation-in-aws-using-cloudtrail-and-eventbridge>#</a></h1><p>One of the most dangerous threats in an AWS environment is <strong>privilege escalation</strong>—when an entity (a user, role, or service) gains more permissions than it should, either by misconfiguration or abuse. Detecting these escalation attempts is essential to protecting your cloud environment.</p><p>AWS does not provide out-of-the-box detection for many of these patterns, but with <strong>CloudTrail</strong>, <strong>EventBridge</strong>, and some <strong>detection engineering</strong>, you can build native alerts for high-risk API calls that indicate an escalation in progress—or one about to happen.</p><p>This article will dive deep into:</p><ul><li>Why privilege escalation is critical</li><li>How attackers typically escalate privileges in AWS</li><li>Which CloudTrail events to monitor</li><li>How to configure EventBridge to catch suspicious patterns</li><li>How to alert in real-time (SNS, Lambda, etc.)</li><li>Caveats and tuning recommendations</li></ul><hr><h2 id=why-privilege-escalation-matters-in-aws>Why Privilege Escalation Matters in AWS<a hidden class=anchor aria-hidden=true href=#why-privilege-escalation-matters-in-aws>#</a></h2><p>Unlike traditional infrastructure, in AWS <strong>permissions are programmable</strong>, and every misstep can have systemic impact. Privilege escalation is not theoretical—it has been exploited both in internal red team exercises and real-world attacks.</p><p>For example, an attacker with limited access to Lambda functions might:</p><ul><li>Modify an existing function to assume a high-privilege IAM role</li><li>Add a new inline policy to their own user</li><li>Or pass an admin role to an EC2 instance they control</li></ul><p>All of these leave traces in <strong>CloudTrail</strong>—if you&rsquo;re watching.</p><hr><h2 id=common-privilege-escalation-techniques-in-aws>Common Privilege Escalation Techniques in AWS<a hidden class=anchor aria-hidden=true href=#common-privilege-escalation-techniques-in-aws>#</a></h2><p>Most escalation paths involve IAM or STS actions. Here are common patterns:</p><table><thead><tr><th>Action</th><th>What It Does</th></tr></thead><tbody><tr><td><code>iam:AttachUserPolicy</code> / <code>AttachRolePolicy</code></td><td>Grants an existing policy to a principal</td></tr><tr><td><code>iam:PutUserPolicy</code> / <code>PutRolePolicy</code></td><td>Creates an inline policy (can contain anything)</td></tr><tr><td><code>iam:PassRole</code> + <code>ec2:RunInstances</code></td><td>Launches EC2 with powerful role attached</td></tr><tr><td><code>lambda:UpdateFunctionCode</code> + <code>iam:PassRole</code></td><td>Runs arbitrary code under elevated permissions</td></tr><tr><td><code>sts:AssumeRole</code></td><td>Switches identity if allowed by trust policy</td></tr><tr><td><code>iam:CreatePolicyVersion</code></td><td>May set an older, more permissive version as active</td></tr></tbody></table><p>Even if you&rsquo;re using SCPs or guardrails, these events are useful for threat hunting or detection.</p><hr><h2 id=cloudtrail-configuration>CloudTrail Configuration<a hidden class=anchor aria-hidden=true href=#cloudtrail-configuration>#</a></h2><p>Ensure you have:</p><ul><li><strong>CloudTrail enabled in all regions</strong></li><li>Logging for <strong>management events</strong></li><li>Optionally delivering to an S3 bucket and integrated with CloudWatch Logs to bypass the 90 day retention limit of Cloudtrail</li></ul><p>All of the mentioned escalation actions are <strong>management events</strong>, and appear in CloudTrail as part of the <code>eventName</code> field.</p><p>Example CloudTrail log (truncated):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;eventName&#34;</span>: <span style=color:#e6db74>&#34;AttachUserPolicy&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;eventSource&#34;</span>: <span style=color:#e6db74>&#34;iam.amazonaws.com&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;userIdentity&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;IAMUser&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;userName&#34;</span>: <span style=color:#e6db74>&#34;alice&#34;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;requestParameters&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;userName&#34;</span>: <span style=color:#e6db74>&#34;alice&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;policyArn&#34;</span>: <span style=color:#e6db74>&#34;arn:aws:iam::aws:policy/AdministratorAccess&#34;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>...</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><hr><h2 id=creating-detection-rules-with-eventbridge>Creating Detection Rules with EventBridge<a hidden class=anchor aria-hidden=true href=#creating-detection-rules-with-eventbridge>#</a></h2><p>EventBridge can subscribe to the CloudTrail event stream and match on <strong>suspicious API calls</strong>. You can then trigger notifications or automated actions.</p><h3 id=rule-example-detect-attachuserpolicy>Rule Example: Detect AttachUserPolicy<a hidden class=anchor aria-hidden=true href=#rule-example-detect-attachuserpolicy>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;source&#34;</span>: [<span style=color:#e6db74>&#34;aws.iam&#34;</span>],
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;detail-type&#34;</span>: [<span style=color:#e6db74>&#34;AWS API Call via CloudTrail&#34;</span>],
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;detail&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;eventName&#34;</span>: [<span style=color:#e6db74>&#34;AttachUserPolicy&#34;</span>, <span style=color:#e6db74>&#34;PutUserPolicy&#34;</span>],
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;requestParameters.policyArn&#34;</span>: [{
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;prefix&#34;</span>: <span style=color:#e6db74>&#34;arn:aws:iam::aws:policy/AdministratorAccess&#34;</span>
</span></span><span style=display:flex><span>    }]
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>This rule matches when someone attaches <code>AdministratorAccess</code> to themselves (or anyone).</p><h3 id=other-useful-event-names-to-watch>Other Useful Event Names to Watch<a hidden class=anchor aria-hidden=true href=#other-useful-event-names-to-watch>#</a></h3><ul><li><code>CreatePolicy</code></li><li><code>CreatePolicyVersion</code></li><li><code>SetDefaultPolicyVersion</code></li><li><code>PutRolePolicy</code></li><li><code>PassRole</code></li><li><code>AssumeRole</code></li></ul><p>If you’re watching cross-service escalation:</p><ul><li><code>RunInstances</code> (check if <code>iam:PassRole</code> was used)</li><li><code>UpdateFunctionCode</code> (especially if the Lambda uses an elevated role)</li></ul><hr><h2 id=alerting-via-sns-or-lambda>Alerting via SNS or Lambda<a hidden class=anchor aria-hidden=true href=#alerting-via-sns-or-lambda>#</a></h2><p>Once your EventBridge rule matches, you can:</p><ul><li>Trigger an <strong>SNS notification</strong> (email, Slack, SMS)</li><li>Invoke a <strong>Lambda function</strong> that writes to a SIEM, sends to Discord, or logs to S3</li><li>Write to <strong>CloudWatch Logs</strong> for later review</li></ul><h3 id=example-send-to-sns>Example: Send to SNS<a hidden class=anchor aria-hidden=true href=#example-send-to-sns>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;State&#34;</span>: <span style=color:#e6db74>&#34;ENABLED&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Targets&#34;</span>: [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;Arn&#34;</span>: <span style=color:#e6db74>&#34;arn:aws:sns:us-east-1:111122223333:PrivEscAlerts&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;Id&#34;</span>: <span style=color:#e6db74>&#34;PrivEscAlertTarget&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><hr><h2 id=tuning-and-limitations>Tuning and Limitations<a hidden class=anchor aria-hidden=true href=#tuning-and-limitations>#</a></h2><h3 id=false-positives>False Positives<a hidden class=anchor aria-hidden=true href=#false-positives>#</a></h3><ul><li>Some actions might be part of normal automation pipelines</li><li>Devs might update Lambda or IAM configs legitimately</li></ul><p>You can reduce noise by:</p><ul><li>Filtering on <code>userIdentity.principalId</code> or <code>userName</code></li><li>Excluding known automation roles (with conditions in EventBridge)</li><li>Only alerting on attachments of <em>privileged</em> policies (e.g., <code>AdministratorAccess</code>, <code>PowerUserAccess</code>)</li></ul><h3 id=blind-spots>Blind Spots<a hidden class=anchor aria-hidden=true href=#blind-spots>#</a></h3><ul><li><strong>Inline policy abuse</strong> might not be obvious</li><li>If CloudTrail isn’t enabled in all regions, you’ll miss stuff</li><li>Identity switching (<code>sts:AssumeRole</code>) requires combining multiple events to trace the full chain</li></ul><hr><h2 id=related-reading>Related Reading<a hidden class=anchor aria-hidden=true href=#related-reading>#</a></h2><p>If this post interests you, check these out:</p><ul><li><a href=/posts/aws-enforcing-least-privilege/>Enforcing Least Privilege in AWS IAM</a></li><li><a href=/posts/aws-ir-toolkit/>AWS Incident Response Toolkit</a></li><li><a href=/posts/aws-securing-ec2-access-with-ssm/>Securing EC2 Access with AWS Systems Manager</a></li><li><a href=/posts/aws-security-checklist-2025/>AWS Security Checklist 2025</a></li></ul><hr><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>Privilege escalation is one of the most critical actions you need to monitor in AWS. While AWS provides the logs (via CloudTrail), it’s your responsibility to wire up detection logic. Thankfully, with <strong>EventBridge</strong> and <strong>a few well-designed rules</strong>, you can begin detecting these escalation attempts in near real-time.</p><p>Even a single detection rule—targeting <code>AttachUserPolicy</code> with <code>AdministratorAccess</code>—can surface abuse before it becomes a breach.</p><p>Don’t wait for an incident to act. Harden your detection stack today.</p><hr></div><section class="mt-10 border-t border-gray-700 pt-6"><div class="flex items-center space-x-4"><div class=text-gray-400><p class=text-sm>Written by <span class="font-semibold text-gray-300">Javier Pulido</span><br>Cloud Security Engineer | Founder of <span class=italic>The Hidden Port</span><br><a href=/about/ class="text-primary hover:underline text-sm">Learn more ➔</a></p></div></div></section><hr><section class=mt-10><h2 style=padding-bottom:10px class="text-2xl font-semibold mb-4">Related Posts by tags</h2><br><span><a style=font-size:17px href=https://thehiddenport.dev/posts/aws-enforcing-least-privilege/ class="title next hover:text-primary">Enforcing Least Privilege in AWS IAM with Access Analyzer and Last Access Data</a></span></br><span><a style=font-size:17px href=https://thehiddenport.dev/posts/aws-securing-ec2-access-with-ssm/ class="title next hover:text-primary">Securing EC2 Access with AWS Systems Manager Session Manager: Eliminating SSH</a></span></br><span><a style=font-size:17px href=https://thehiddenport.dev/posts/aws-ami-hardening/ class="title next hover:text-primary">Building a Hardened Amazon Linux 2 AMI for Secure EC2 Deployments</a></span></br></section><hr><footer class=post-footer><ul class=post-tags><li><a href=https://thehiddenport.dev/tags/aws/>Aws</a></li><li><a href=https://thehiddenport.dev/tags/iam/>Iam</a></li><li><a href=https://thehiddenport.dev/tags/cloudtrail/>Cloudtrail</a></li><li><a href=https://thehiddenport.dev/tags/eventbridge/>Eventbridge</a></li><li><a href=https://thehiddenport.dev/tags/detection/>Detection</a></li><li><a href=https://thehiddenport.dev/tags/security/>Security</a></li></ul><nav class=paginav><a class=prev href=https://thehiddenport.dev/posts/aws-guardduty-setup/><span class=title>« Prev</span><br><span>Getting Started with Amazon GuardDuty: Setup, Findings, and SIEM Integration</span>
</a><a class=next href=https://thehiddenport.dev/posts/aws-ami-hardening/><span class=title>Next »</span><br><span>Building a Hardened Amazon Linux 2 AMI for Secure EC2 Deployments</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Detecting Privilege Escalation in AWS Using CloudTrail and EventBridge on x" href="https://x.com/intent/tweet/?text=Detecting%20Privilege%20Escalation%20in%20AWS%20Using%20CloudTrail%20and%20EventBridge&amp;url=https%3a%2f%2fthehiddenport.dev%2fposts%2faws-detecting-privilege-escalation%2f&amp;hashtags=AWS%2cIAM%2cCloudTrail%2cEventBridge%2cDetection%2cSecurity"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Detecting Privilege Escalation in AWS Using CloudTrail and EventBridge on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fthehiddenport.dev%2fposts%2faws-detecting-privilege-escalation%2f&amp;title=Detecting%20Privilege%20Escalation%20in%20AWS%20Using%20CloudTrail%20and%20EventBridge&amp;summary=Detecting%20Privilege%20Escalation%20in%20AWS%20Using%20CloudTrail%20and%20EventBridge&amp;source=https%3a%2f%2fthehiddenport.dev%2fposts%2faws-detecting-privilege-escalation%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Detecting Privilege Escalation in AWS Using CloudTrail and EventBridge on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fthehiddenport.dev%2fposts%2faws-detecting-privilege-escalation%2f&title=Detecting%20Privilege%20Escalation%20in%20AWS%20Using%20CloudTrail%20and%20EventBridge"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Detecting Privilege Escalation in AWS Using CloudTrail and EventBridge on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fthehiddenport.dev%2fposts%2faws-detecting-privilege-escalation%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Detecting Privilege Escalation in AWS Using CloudTrail and EventBridge on whatsapp" href="https://api.whatsapp.com/send?text=Detecting%20Privilege%20Escalation%20in%20AWS%20Using%20CloudTrail%20and%20EventBridge%20-%20https%3a%2f%2fthehiddenport.dev%2fposts%2faws-detecting-privilege-escalation%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Detecting Privilege Escalation in AWS Using CloudTrail and EventBridge on telegram" href="https://telegram.me/share/url?text=Detecting%20Privilege%20Escalation%20in%20AWS%20Using%20CloudTrail%20and%20EventBridge&amp;url=https%3a%2f%2fthehiddenport.dev%2fposts%2faws-detecting-privilege-escalation%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Detecting Privilege Escalation in AWS Using CloudTrail and EventBridge on ycombinator" href="https://news.ycombinator.com/submitlink?t=Detecting%20Privilege%20Escalation%20in%20AWS%20Using%20CloudTrail%20and%20EventBridge&u=https%3a%2f%2fthehiddenport.dev%2fposts%2faws-detecting-privilege-escalation%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://thehiddenport.dev/>The Hidden Port</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><style>.subscribe-footer{margin-top:3rem;padding-top:1.5rem;border-top:1px solid #444;text-align:center!important;justify-content:center;align-items:center}.subscribe-footer .eo-wrapper{width:100%;max-width:500px;display:flex;justify-content:center}</style><div class=subscribe-footer><a href=/disclaimer/ class="linktext-xs text-gray-500 hover:text-primary">Disclaimer</a></div><script>const form=document.getElementById("newsletter-form"),successMessage=document.getElementById("subscribe-success");form.addEventListener("submit",async function(e){e.preventDefault();const t=new FormData(form),n=await fetch(form.action,{method:form.method,body:t});n.ok&&(form.reset(),successMessage.classList.add("show"),successMessage.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{successMessage.classList.remove("show"),successMessage.classList.add("hide")},5e3))})</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script async src=https://eocampaign1.com/form/fbc81a40-4aea-11f0-aff3-45842a94a714.js data-form=fbc81a40-4aea-11f0-aff3-45842a94a714></script></body></html>